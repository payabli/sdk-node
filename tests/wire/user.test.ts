/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool.js";
import * as Payabli from "../../src/api/index";
import { PayabliClient } from "../../src/Client";

describe("User", () => {
    test("AddUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { isSuccess: true, responseText: "Success" };
        server
            .mockEndpoint()
            .post("/User")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.addUser({});
        expect(response).toEqual({
            isSuccess: true,
            responseText: "Success",
        });
    });

    test("AuthRefreshUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            inactiveTokenTime: 31,
            isSuccess: true,
            remaining: 120,
            responseData: "u.fPLVSzFv1gZpHl......",
            responseText: "Success",
        };
        server.mockEndpoint().post("/User/authrefresh").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.user.authRefreshUser();
        expect(response).toEqual({
            inactiveTokenTime: 31,
            isSuccess: true,
            remaining: 120,
            responseData: "u.fPLVSzFv1gZpHl......",
            responseText: "Success",
        });
    });

    test("AuthResetUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { isSuccess: true, responseText: "Success" };
        server
            .mockEndpoint()
            .post("/User/authreset")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.authResetUser();
        expect(response).toEqual({
            isSuccess: true,
            responseText: "Success",
        });
    });

    test("AuthUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = {
            isSuccess: true,
            mfa: false,
            mfaMode: "email",
            mfaValidationCode: "50-2E-4A-16-93-0E-41-41-07-EE-22-B6-00-99-00-99",
            responseData: "g**.com",
            responseText: "Success",
        };
        server
            .mockEndpoint()
            .post("/User/auth/provider")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.authUser("provider");
        expect(response).toEqual({
            isSuccess: true,
            mfa: false,
            mfaMode: "email",
            mfaValidationCode: "50-2E-4A-16-93-0E-41-41-07-EE-22-B6-00-99-00-99",
            responseData: "g**.com",
            responseText: "Success",
        });
    });

    test("ChangePswUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { isSuccess: true, responseText: "Success" };
        server
            .mockEndpoint()
            .put("/User/authpsw")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.changePswUser();
        expect(response).toEqual({
            isSuccess: true,
            responseText: "Success",
        });
    });

    test("DeleteUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { responseText: "Success" };
        server.mockEndpoint().delete("/User/1000000").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.user.deleteUser(1000000);
        expect(response).toEqual({
            responseText: "Success",
        });
    });

    test("EditMfaUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { isSuccess: true, responseText: "Success" };
        server
            .mockEndpoint()
            .put("/User/mfa/1000000")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.editMfaUser(1000000, {});
        expect(response).toEqual({
            isSuccess: true,
            responseText: "Success",
        });
    });

    test("EditUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = { isSuccess: true, responseText: "Success" };
        server
            .mockEndpoint()
            .put("/User/1000000")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.editUser(1000000, {});
        expect(response).toEqual({
            isSuccess: true,
            responseText: "Success",
        });
    });

    test("GetUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            Access: [{ roleLabel: "customers", roleValue: true }],
            AdditionalData: "AdditionalData",
            createdAt: "2022-07-01T15:00:01Z",
            Email: "example@email.com",
            language: "en",
            lastAccess: "2022-07-01T15:00:01Z",
            Name: "Sean Smith",
            Phone: "5555555555",
            Scope: [{ orgEntry: "pilgrim-planner", orgId: 123, orgType: 0 }],
            snData: "snData",
            snIdentifier: "snIdentifier",
            snProvider: "google",
            timeZone: -5,
            userId: 1000000,
            UsrMFA: false,
            UsrMFAMode: 0,
            UsrStatus: 1,
        };
        server.mockEndpoint().get("/User/1000000").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.user.getUser(1000000, {
            entry: "478ae1234",
        });
        expect(response).toEqual({
            Access: [
                {
                    roleLabel: "customers",
                    roleValue: true,
                },
            ],
            AdditionalData: "AdditionalData",
            createdAt: "2022-07-01T15:00:01Z",
            Email: "example@email.com",
            language: "en",
            lastAccess: "2022-07-01T15:00:01Z",
            Name: "Sean Smith",
            Phone: "5555555555",
            Scope: [
                {
                    orgEntry: "pilgrim-planner",
                    orgId: 123,
                    orgType: 0,
                },
            ],
            snData: "snData",
            snIdentifier: "snIdentifier",
            snProvider: "google",
            timeZone: -5,
            userId: 1000000,
            UsrMFA: false,
            UsrMFAMode: 0,
            UsrStatus: 1,
        });
    });

    test("LogoutUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { isSuccess: true, responseText: "Success" };
        server.mockEndpoint().get("/User/authlogout").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.user.logoutUser();
        expect(response).toEqual({
            isSuccess: true,
            responseText: "Success",
        });
    });

    test("ResendMFACode", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            isSuccess: true,
            mfa: false,
            mfaMode: "email",
            mfaValidationCode: "50-2E-4A-16-93-0E-41-41-07-EE-22-B6-00-99-00-99",
            responseData: "g**.com",
            responseText: "Success",
        };
        server
            .mockEndpoint()
            .post("/User/resendmfa/usrname/Entry/1")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.resendMfaCode("usrname", "Entry", 1);
        expect(response).toEqual({
            isSuccess: true,
            mfa: false,
            mfaMode: "email",
            mfaValidationCode: "50-2E-4A-16-93-0E-41-41-07-EE-22-B6-00-99-00-99",
            responseData: "g**.com",
            responseText: "Success",
        });
    });

    test("ValidateMfaUser", async () => {
        const server = mockServerPool.createServer();
        const client = new PayabliClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = {
            inactiveTokenTime: 31,
            isSuccess: true,
            remaining: 120,
            responseData: "u.fPLVSzFv1gZpHl......",
            responseText: "Success",
        };
        server
            .mockEndpoint()
            .post("/User/mfa")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.user.validateMfaUser();
        expect(response).toEqual({
            inactiveTokenTime: 31,
            isSuccess: true,
            remaining: 120,
            responseData: "u.fPLVSzFv1gZpHl......",
            responseText: "Success",
        });
    });
});
